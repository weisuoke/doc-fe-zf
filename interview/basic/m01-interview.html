<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>m01. 面试 - JS基础听课笔记 | 珠峰架构</title>
    <meta name="generator" content="VuePress 1.4.1">
    
    <meta name="description" content="">
    <link rel="preload" href="/assets/css/0.styles.1657c744.css" as="style"><link rel="preload" href="/assets/js/app.2af561cb.js" as="script"><link rel="preload" href="/assets/js/2.b2a5c435.js" as="script"><link rel="preload" href="/assets/js/11.689524dc.js" as="script"><link rel="prefetch" href="/assets/js/10.2b2c8443.js"><link rel="prefetch" href="/assets/js/12.849e2da9.js"><link rel="prefetch" href="/assets/js/13.c798d95d.js"><link rel="prefetch" href="/assets/js/14.380c4ee7.js"><link rel="prefetch" href="/assets/js/15.d5753b2e.js"><link rel="prefetch" href="/assets/js/16.49eb1f17.js"><link rel="prefetch" href="/assets/js/17.5ecf2b4f.js"><link rel="prefetch" href="/assets/js/18.da9c8265.js"><link rel="prefetch" href="/assets/js/19.59d827ef.js"><link rel="prefetch" href="/assets/js/20.73eb42bb.js"><link rel="prefetch" href="/assets/js/21.8570b5b4.js"><link rel="prefetch" href="/assets/js/22.34094913.js"><link rel="prefetch" href="/assets/js/23.5209939b.js"><link rel="prefetch" href="/assets/js/24.53d92201.js"><link rel="prefetch" href="/assets/js/25.7241adf1.js"><link rel="prefetch" href="/assets/js/26.fecc2611.js"><link rel="prefetch" href="/assets/js/27.e50fca48.js"><link rel="prefetch" href="/assets/js/28.4c168acc.js"><link rel="prefetch" href="/assets/js/29.f5186710.js"><link rel="prefetch" href="/assets/js/3.ba1dcccd.js"><link rel="prefetch" href="/assets/js/30.33cb1c11.js"><link rel="prefetch" href="/assets/js/31.c088791d.js"><link rel="prefetch" href="/assets/js/32.3b724af5.js"><link rel="prefetch" href="/assets/js/33.f975c942.js"><link rel="prefetch" href="/assets/js/34.7d1f4bd2.js"><link rel="prefetch" href="/assets/js/35.26c11750.js"><link rel="prefetch" href="/assets/js/36.e8890e58.js"><link rel="prefetch" href="/assets/js/37.516eba46.js"><link rel="prefetch" href="/assets/js/38.4f8b8525.js"><link rel="prefetch" href="/assets/js/39.26f95568.js"><link rel="prefetch" href="/assets/js/4.fca74266.js"><link rel="prefetch" href="/assets/js/40.b9a8ffbb.js"><link rel="prefetch" href="/assets/js/41.fd02ea5f.js"><link rel="prefetch" href="/assets/js/42.d2483185.js"><link rel="prefetch" href="/assets/js/43.70bff2de.js"><link rel="prefetch" href="/assets/js/44.219702ca.js"><link rel="prefetch" href="/assets/js/45.aba93af9.js"><link rel="prefetch" href="/assets/js/46.447ba87c.js"><link rel="prefetch" href="/assets/js/47.519ddc28.js"><link rel="prefetch" href="/assets/js/48.fd8af347.js"><link rel="prefetch" href="/assets/js/49.b3783fa9.js"><link rel="prefetch" href="/assets/js/5.cc992e8b.js"><link rel="prefetch" href="/assets/js/50.0bb20f92.js"><link rel="prefetch" href="/assets/js/51.37ba1a59.js"><link rel="prefetch" href="/assets/js/52.054af132.js"><link rel="prefetch" href="/assets/js/53.5aca78a0.js"><link rel="prefetch" href="/assets/js/54.78c43f89.js"><link rel="prefetch" href="/assets/js/55.8ecaadc1.js"><link rel="prefetch" href="/assets/js/56.e844f110.js"><link rel="prefetch" href="/assets/js/57.530db0e9.js"><link rel="prefetch" href="/assets/js/58.8c839289.js"><link rel="prefetch" href="/assets/js/59.6634b409.js"><link rel="prefetch" href="/assets/js/6.b8b36e50.js"><link rel="prefetch" href="/assets/js/60.7ebe5787.js"><link rel="prefetch" href="/assets/js/61.bfe89a8b.js"><link rel="prefetch" href="/assets/js/62.4cdf6e8c.js"><link rel="prefetch" href="/assets/js/63.a0e80f0d.js"><link rel="prefetch" href="/assets/js/64.62a1b782.js"><link rel="prefetch" href="/assets/js/65.7be0994b.js"><link rel="prefetch" href="/assets/js/66.5a592a8e.js"><link rel="prefetch" href="/assets/js/67.40b4291c.js"><link rel="prefetch" href="/assets/js/68.2ac34b58.js"><link rel="prefetch" href="/assets/js/69.728773d5.js"><link rel="prefetch" href="/assets/js/7.0414e914.js"><link rel="prefetch" href="/assets/js/70.30137f66.js"><link rel="prefetch" href="/assets/js/71.7735c9fc.js"><link rel="prefetch" href="/assets/js/72.e9f43339.js"><link rel="prefetch" href="/assets/js/73.2d754e71.js"><link rel="prefetch" href="/assets/js/74.bf70dd09.js"><link rel="prefetch" href="/assets/js/75.18c28356.js"><link rel="prefetch" href="/assets/js/76.a0626bc9.js"><link rel="prefetch" href="/assets/js/77.dfde57e0.js"><link rel="prefetch" href="/assets/js/78.b380a0d6.js"><link rel="prefetch" href="/assets/js/79.f7bafb5d.js"><link rel="prefetch" href="/assets/js/8.c3544379.js"><link rel="prefetch" href="/assets/js/80.ade6c33e.js"><link rel="prefetch" href="/assets/js/81.6335ba85.js"><link rel="prefetch" href="/assets/js/82.9d01c14e.js"><link rel="prefetch" href="/assets/js/83.47911fdd.js"><link rel="prefetch" href="/assets/js/9.844fca3b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.1657c744.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">珠峰架构</span></a> <div class="links"><!----> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/react/" class="sidebar-heading clickable"><span>react</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/vue/" class="sidebar-heading clickable"><span>vue</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/webpack/" class="sidebar-heading clickable"><span>webpack</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/flutter/" class="sidebar-heading clickable"><span>flutter</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/interview/" class="sidebar-heading clickable router-link-active open"><span>interview</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/interview/basic/" class="sidebar-heading clickable router-link-active open"><span>基础</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/interview/basic/01-interview.html" class="sidebar-link">01. 面试 - JS基础</a></li><li><a href="/interview/basic/m01-interview.html" class="active sidebar-link">m01. 面试 - JS基础听课笔记</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/interview/basic/m01-interview.html#执行上下文" class="sidebar-link">执行上下文</a></li><li class="sidebar-sub-header"><a href="/interview/basic/m01-interview.html#执行上下文栈" class="sidebar-link">执行上下文栈</a></li><li class="sidebar-sub-header"><a href="/interview/basic/m01-interview.html#作用域链-important" class="sidebar-link">作用域链 (important)</a></li><li class="sidebar-sub-header"><a href="/interview/basic/m01-interview.html#ao-激活对象" class="sidebar-link">AO (激活对象)</a></li><li class="sidebar-sub-header"><a href="/interview/basic/m01-interview.html#闭包" class="sidebar-link">闭包</a></li><li class="sidebar-sub-header"><a href="/interview/basic/m01-interview.html#this" class="sidebar-link">this</a></li></ul></li></ul></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/other/" class="sidebar-heading clickable"><span>other</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="m01-面试-js基础听课笔记"><a href="#m01-面试-js基础听课笔记" class="header-anchor">#</a> m01. 面试 - JS基础听课笔记</h1> <h2 id="执行上下文"><a href="#执行上下文" class="header-anchor">#</a> 执行上下文</h2> <p><img src="https://wsk-mweb.oss-cn-hangzhou.aliyuncs.com/2020-06-25-170407.png" alt="image-20200626010406082"></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">task</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'zhufeng'</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">task</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// task的执行上下文</span>
<span class="token keyword">let</span> taskExecutionContext <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token operator">:</span> window<span class="token punctuation">,</span>
  scopeChain<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token comment">// Variable Object变量对象 里面存的是当前函数执行要使用到的变量</span>
  <span class="token constant">VO</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    arguments<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    a<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    b<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">xo1</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    c<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">xa1</span><span class="token template-punctuation string">`</span></span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><img src="https://wsk-mweb.oss-cn-hangzhou.aliyuncs.com/2020-06-25-170841.png" alt="image-20200626010839723"></p> <p>(<strong>Local指的是VO</strong>)</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> a<span class="token punctuation">;</span>

b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 👉 1</span>
</code></pre></div><p>基本数据类型赋值，和引用数据类型赋值不一样</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> executionContext <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">VO</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
executionContext<span class="token punctuation">.</span><span class="token constant">VO</span><span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
executionContext<span class="token punctuation">.</span><span class="token constant">VO</span><span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
executionContext<span class="token punctuation">.</span><span class="token constant">VO</span><span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>executionContext<span class="token punctuation">.</span><span class="token constant">VO</span><span class="token punctuation">.</span>a<span class="token punctuation">)</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> m <span class="token operator">=</span> <span class="token punctuation">{</span>a<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">;</span>	<span class="token comment">// xo1</span>
<span class="token comment">// 如果是引用数据类型，赋值的时候赋值的是引用地址</span>
<span class="token keyword">var</span> n <span class="token operator">=</span> m<span class="token punctuation">;</span> <span class="token comment">// n = xo1</span>
n<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>	<span class="token comment">// {a: 10, b: 2}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 👉 10</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> executionContext <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">VO</span><span class="token operator">:</span> <span class="token punctuation">{</span> m<span class="token operator">:</span> <span class="token punctuation">{</span>a<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
executionContext<span class="token punctuation">.</span><span class="token constant">VO</span><span class="token punctuation">.</span>n <span class="token operator">=</span> executionContext<span class="token punctuation">.</span><span class="token constant">VO</span><span class="token punctuation">.</span>m
executionContext<span class="token punctuation">.</span><span class="token constant">VO</span><span class="token punctuation">.</span>n <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>executionContext<span class="token punctuation">.</span><span class="token constant">VO</span><span class="token punctuation">.</span>m<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 👉 10</span>
</code></pre></div><h2 id="执行上下文栈"><a href="#执行上下文栈" class="header-anchor">#</a> 执行上下文栈</h2> <p><img src="https://wsk-mweb.oss-cn-hangzhou.aliyuncs.com/2020-06-25-172143.png" alt="image-20200626012140519"></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> globalExecutionContext <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">VO</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    setTimeout<span class="token punctuation">,</span>
    Math<span class="token punctuation">,</span>
    String
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> window <span class="token operator">=</span> globalExecutionContext<span class="token punctuation">.</span><span class="token constant">VO</span><span class="token punctuation">;</span>
window<span class="token punctuation">.</span>setInterval<span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">one</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">one</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> oneExecutionContext <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// oneExecutionContext.VO 对象我们是无法访问和获取的</span>
  <span class="token comment">// 为什么不让访问，是为了保护里面的变量不能</span>
  <span class="token constant">VO</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    a<span class="token operator">:</span> <span class="token number">10</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="疑问"><a href="#疑问" class="header-anchor">#</a> 疑问</h3> <blockquote><ol><li>let 申明的变量为什么在 Window 上访问不到？let 和 var 区别？</li></ol></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">one</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> <span class="token function-variable function">two</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> <span class="token function-variable function">three</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">three</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">two</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">one</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>使用VO、AO、GO来描述</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> executeContextStack <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// 全局上下文</span>
<span class="token keyword">var</span> globalExecuteContext <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">VO</span><span class="token operator">:</span> <span class="token punctuation">{</span> one<span class="token operator">:</span> <span class="token string">'() =&gt; {}'</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
executeContextStack <span class="token operator">=</span> <span class="token punctuation">[</span>globalExecuteContext<span class="token punctuation">]</span>

<span class="token keyword">var</span> oneExecuteContext <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">VO</span><span class="token operator">:</span> <span class="token punctuation">{</span>a<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> two<span class="token operator">:</span> <span class="token string">'() =&gt; {}'</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
executeContextStack <span class="token operator">=</span> <span class="token punctuation">[</span>oneExecuteContext<span class="token punctuation">,</span> globalExecuteContext<span class="token punctuation">]</span>

<span class="token keyword">var</span> twoExecuteContext <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">VO</span><span class="token operator">:</span> <span class="token punctuation">{</span>b<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> three<span class="token operator">:</span> <span class="token string">'() =&gt; {}'</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

executeContextStack <span class="token operator">=</span> <span class="token punctuation">[</span>twoExecuteContext<span class="token punctuation">,</span> oneExecuteContext<span class="token punctuation">,</span> globalExecuteContext<span class="token punctuation">]</span>

<span class="token keyword">var</span> threeExecuteContext <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">VO</span><span class="token operator">:</span> <span class="token punctuation">{</span>c<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 执行上下文栈</span>
executeContextStack <span class="token operator">=</span> <span class="token punctuation">[</span>threeExecuteContext<span class="token punctuation">,</span> twoExecuteContext<span class="token punctuation">,</span> oneExecuteContext<span class="token punctuation">,</span> globalExecuteContext<span class="token punctuation">]</span>

<span class="token comment">// console.log(a, b, c)</span>
<span class="token comment">// 变量的值是如何查找的</span>

<span class="token comment">// 作用域链的查找过程</span>
<span class="token keyword">function</span> <span class="token function">getVariableValue</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> executeContextStack<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>varName <span class="token keyword">in</span> executeContextStack<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token constant">VO</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> executeContextStack<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token constant">VO</span><span class="token punctuation">[</span>varName<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">getVariableValue</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getVariableValue</span><span class="token punctuation">(</span><span class="token string">'b'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getVariableValue</span><span class="token punctuation">(</span><span class="token string">'c'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><blockquote><p>什么叫作用域？</p> <p>作用域就是一个一个上下文</p></blockquote> <h2 id="作用域链-important"><a href="#作用域链-important" class="header-anchor">#</a> 作用域链 (important)</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * 作用域链在函数创建的时候就已经确定了，根在哪里执行没有关系
 */</span>
<span class="token keyword">function</span> <span class="token function">one</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token function">two</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 函数创建的时候就已经定下来了</span>
  <span class="token comment">// two['[[Scopes]]'] = [oneExecutionContextVo, globalExecutionContextVo]</span>
  <span class="token keyword">return</span> two<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> outer_two <span class="token operator">=</span> <span class="token function">one</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">outer_two</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 打印1</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 现在开始代码执行</span>
<span class="token comment">// 执行上下文有两个阶段，第一个是编译阶段，第二个是执行阶段</span>
<span class="token comment">// 编译阶段会寻找里面的 var 变量声明和函数声明，进行变量提升</span>
<span class="token keyword">var</span> globalExecutionContextVo <span class="token operator">=</span> <span class="token punctuation">{</span>
  one<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">() =&gt; {}</span><span class="token template-punctuation string">`</span></span> <span class="token comment">// 函数声明的话会声明并赋值</span>
  a<span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>	<span class="token comment">// var 变量会声明，但不赋值</span>
  outer_two<span class="token operator">:</span> <span class="token keyword">undefined</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> globalExecutionContext <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">VO</span><span class="token operator">:</span> globalExecutionContextVo
  scopeChain<span class="token operator">:</span> <span class="token punctuation">[</span>globalExecutionContextVo<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token comment">// 开始执行</span>
globalExecutionContext<span class="token punctuation">.</span><span class="token constant">VO</span><span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>

<span class="token comment">// 进入 one 函数的执行的时候的执行上下文的编译阶段 function var</span>
<span class="token comment">// two 这个函数的作用域链其实是在创建 oneExecutionContext 的时候确定的</span>
<span class="token keyword">var</span> oneExecutionContextVo <span class="token operator">=</span> <span class="token punctuation">{</span>
  two<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">() =&gt; {}</span><span class="token template-punctuation string">`</span></span>
  a<span class="token operator">:</span> <span class="token keyword">undefined</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> oneExecutionContext <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">VO</span><span class="token operator">:</span> oneExecutionContextVo<span class="token punctuation">,</span>
  scopeChain<span class="token operator">:</span> <span class="token punctuation">[</span>oneExecutionContextVo<span class="token punctuation">,</span> globalExecutionContextVo<span class="token punctuation">]</span>
<span class="token punctuation">}</span> 
<span class="token comment">// 开始执行 oneExecutionContext 的执行阶段</span>
oneExecutionContext<span class="token punctuation">.</span><span class="token constant">VO</span><span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">1</span>
globalExecutionContext<span class="token punctuation">.</span><span class="token constant">VO</span><span class="token punctuation">.</span>outer_two <span class="token operator">=</span> <span class="token string">&quot;two&quot;</span>

<span class="token comment">// two</span>
<span class="token keyword">var</span> twoneExecutionContextVo <span class="token operator">=</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token comment">// two 这个函数的作用域其实并不是在这个时候，也就是不是在two执行的时候创建或确定的！</span>
<span class="token keyword">var</span> twoExecutionContext <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">VO</span><span class="token operator">:</span> twoneExecutionContextVo<span class="token punctuation">,</span>
 	scopeChain<span class="token operator">:</span> <span class="token punctuation">[</span>twoExecutionContextVo<span class="token punctuation">,</span> <span class="token operator">...</span>two<span class="token punctuation">[</span><span class="token string">'[[Scopes]]'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
  <span class="token comment">// scopeChain: [twoExecutionContextVo, oneExecutionContextVo, globalExecutionContextVo]</span>
<span class="token punctuation">}</span> 
</code></pre></div><blockquote><p><strong>一个好的问题：</strong></p> <p>作用域链不是在上下文中么，但是上下文不是函数执行才创建么是不是和作用域链在函数创建的时候就确定了有冲突</p></blockquote> <h2 id="ao-激活对象"><a href="#ao-激活对象" class="header-anchor">#</a> AO (激活对象)</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * VO
 * Local
 * this
 */</span>
<span class="token keyword">function</span> <span class="token function">one</span><span class="token punctuation">(</span><span class="token parameter">m</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">two</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'two'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function">two</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">one</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> globalVO <span class="token operator">=</span> <span class="token punctuation">{</span>one<span class="token operator">:</span> <span class="token string">'one'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> globalEC <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token constant">VO</span><span class="token operator">:</span> globalVO<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token operator">:</span> window<span class="token punctuation">,</span> scopeChain<span class="token operator">:</span> <span class="token punctuation">[</span>globalVO<span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token keyword">let</span> ECStack <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
ECStack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>globalEC<span class="token punctuation">)</span>
<span class="token comment">// ===============================</span>
<span class="token keyword">let</span> oneVo <span class="token operator">=</span> <span class="token punctuation">{</span> two<span class="token operator">:</span> <span class="token string">'fn two'</span> <span class="token punctuation">}</span>
<span class="token keyword">let</span> oneEC <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token constant">VO</span><span class="token operator">:</span> oneVo<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token operator">:</span> window<span class="token punctuation">,</span> scopeChain<span class="token operator">:</span> <span class="token punctuation">[</span>oneVo<span class="token punctuation">,</span> globalVO<span class="token punctuation">]</span> <span class="token punctuation">}</span>
ECStack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>oneEC<span class="token punctuation">)</span>
<span class="token comment">// 当 one 开始执行的时候，因为 oneEC 处于执行栈的顶端，这个时候，oneVO 就会成为 AO</span>
<span class="token comment">// Activation Object oneVo.this = window</span>
<span class="token keyword">let</span> twoVo <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token keyword">let</span> twoEC <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token constant">VO</span><span class="token operator">:</span> twoVo<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token operator">:</span> window<span class="token punctuation">,</span> scopeChain<span class="token operator">:</span> <span class="token punctuation">[</span>twoVo<span class="token punctuation">,</span> oneVo<span class="token punctuation">,</span> globalVO<span class="token punctuation">]</span> <span class="token punctuation">}</span>
ECStack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>twoEC<span class="token punctuation">)</span>
ECStack<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
ECStack<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="闭包"><a href="#闭包" class="header-anchor">#</a> 闭包</h2> <ul><li>闭包有两部分组成，一个是当前的执行上下文A，一个是在该执行上下文中创建的函数B</li> <li>当B执行的时候引用了当前执行上下文A中的变量就会产出闭包</li> <li>当一个值失去引用的时候就会会标记，被垃圾收集回收机回收并释放空间</li> <li>闭包的本质就是在函数外部保持内部变量的引用，从而阻止垃圾回收</li> <li>调用栈的并不会影响作用域链,函数调用栈是在执行时才确定，而作用域规则是在代码编译阶段就已经确定了</li> <li>MDN定义:闭包是指这样的作用域<code>foo</code>,它包含了一个函数<code>fn</code>，这个函数<code>fn1</code>可以调用被这个作用域所封闭的变量<code>a</code>、函数等内容</li></ul> <blockquote><p>？？？？</p> <p>作用域链是在创建函数的时候确定的</p> <p>调用栈是在调用的时候确定的</p></blockquote> <h2 id="this"><a href="#this" class="header-anchor">#</a> this</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * 如何确定 this
 * 思考 this 为什么会出现？我们需要 this 干什么用
 * this 谁来调用， 或者说当前执行这个逻辑的主体是谁
 * 函数只是一个处理逻辑
 */</span>

<span class="token keyword">function</span> <span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  
<span class="token punctuation">}</span>

<span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 当前执行 getName 方法主体的名字</span>
<span class="token keyword">function</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> person <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'张三'</span><span class="token punctuation">,</span>
  <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

<span class="token comment">// 怎么确定 this, 干这件事，那么 this 就是谁</span>
<span class="token comment">// 在 JS 里，谁调用哪个方法</span>
person<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 如何确定 this， `.` 前面的对象</span>

<span class="token comment">/**
 * 如何确定 this，其实就是知道当前函数执行主体是谁？
 */</span>
<span class="token comment">// 如果是对象来调，this就是调用的对象</span>

<span class="token comment">// 如果没有人来调，直接执行</span>
<span class="token comment">// 如果是非严格模式，主体是 window、global</span>
<span class="token comment">// 如果是严格模式，是 undefined</span>

<span class="token comment">// 其实 this 的确定只有一条规定，谁调用方法就是谁</span>
<span class="token comment">// 如果是事件绑定的时候，this就是绑定的元素</span>

<span class="token keyword">let</span> dom <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    dom<span class="token punctuation">[</span><span class="token string">&quot;on&quot;</span> <span class="token operator">+</span> type<span class="token punctuation">]</span> <span class="token operator">=</span> callback<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">emit</span><span class="token punctuation">(</span><span class="token parameter">type</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    dom<span class="token punctuation">[</span><span class="token string">&quot;on&quot;</span> <span class="token operator">+</span> type<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

dom<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// this 就是当前的元素</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="call-apply-bind"><a href="#call-apply-bind" class="header-anchor">#</a> call apply bind</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * call 调用方法
 * apply 调用方法
 * bind 绑定方法
 */</span>
<span class="token keyword">function</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'zhufeng'</span>
<span class="token punctuation">}</span>

<span class="token comment">// 以 obj 作为调用方，或者说执行主体，调用 getName 方法</span>
<span class="token function">getName</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
</code></pre></div><h3 id="call-的原理"><a href="#call-的原理" class="header-anchor">#</a> call 的原理</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 实现 call</span>
<span class="token operator">!</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">prototype</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">call2</span><span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    context<span class="token punctuation">.</span>getName <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    context<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">delete</span> context<span class="token punctuation">.</span>getName
  <span class="token punctuation">}</span>
  prototype<span class="token punctuation">.</span>call2 <span class="token operator">=</span> call2
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>
getName<span class="token punctuation">.</span><span class="token function">call2</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">更新时间:</span> <span class="time">7/11/2020, 3:44:30 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/interview/basic/01-interview.html" class="prev">
        01. 面试 - JS基础
      </a></span> <span class="next"><a href="/other/01-https.html">
        01. HTTPS简介
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.2af561cb.js" defer></script><script src="/assets/js/2.b2a5c435.js" defer></script><script src="/assets/js/11.689524dc.js" defer></script>
  </body>
</html>
